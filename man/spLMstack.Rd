% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spLMstack.R
\name{spLMstack}
\alias{spLMstack}
\title{Univariate spatial linear model using Bayesian predictive stacking}
\usage{
spLMstack(
  formula,
  data = parent.frame(),
  coords,
  cor.fn,
  priors,
  params.list,
  n.samples,
  loopd.method,
  parallel = FALSE,
  solver = "ECOS",
  verbose = TRUE,
  ...
)
}
\arguments{
\item{formula}{a symbolic description of the regression model to be fit.
See example below.}

\item{data}{an optional data frame containing the variables in the model.
If not found in \code{data}, the variables are taken from
\code{environment(formula)}, typically the environment from which
\code{spLMstack} is called.}

\item{coords}{an \eqn{n \times 2}{n x 2} matrix of the observation
coordinates in \eqn{R^2}{R^2} (e.g., easting and northing).}

\item{cor.fn}{a quoted keyword that specifies the correlation function used
to model the spatial dependence structure among the observations. Supported
covariance model key words are: \code{'exponential'} and \code{'matern'}.
See below for details.}

\item{priors}{a list with each tag corresponding to a parameter name and
containing prior details.}

\item{params.list}{a list containing candidate values of spatial process
parameters and noise-to-spatial variance ratio. See example.}

\item{n.samples}{number of posterior samples to be generated.}

\item{loopd.method}{character. Valid inputs are \code{'exact'} and \code{'PSIS'}. The
option \code{'exact'} corresponds to exact leave-one-out predictive densities.
The option \code{'PSIS'} is faster, as it finds approximate leave-one-out
predictive densities using Pareto-smoothed importance sampling
(Gelman \emph{et al.} 2024).}

\item{parallel}{logical. If \code{FALSE}, the parallelization plan, if set up
by the user, is ignored. If \code{TRUE}, inherits the parallelization plan
set by the user using the \code{future} package.}

\item{solver}{(optional) Specifies the name of the solver that will be used
to obtain optimal stacking weights for each candidate model. Default is
\code{"ECOS"}. Users can use other solvers supported by the \link{CVXR} package.}

\item{verbose}{logical. If \code{TRUE}, prints model-specific optimal
stacking weights.}

\item{...}{currently no additional argument.}
}
\value{
An object of class \code{spLMstack}, which is a list with the
following tags -
\item{samples}{a list of length equal to total number of candidate models
with each entry corresponding to a list of length 4, containing posterior
samples of fixed effects (\code{beta}), variance parameter
(\code{sigmaSq}), spatial effects (\code{z}), and, leave-one-out predictive
densities (\code{loopd}) for that particular model.}
\item{n.models}{number of candidate models that are fit.}
\item{candidate.models}{a matrix with \code{n_model} rows with each row
containing details of the model parameters and its optimal weight.}
\item{stacking.weights}{a numeric vector of length equal to the number of
candidate models storing the optimal stacking weights.}
\item{run.time}{a \code{proc_time} object with runtime details.}
\item{solver.status}{solver status as returned by the optimization routine.}
The return object might include additional data used for subsequent
prediction and/or model fit evaluation.
}
\description{
Fits Bayesian spatial linear model on several candidate models
specified by user via candidate values of some spatial process parameters
and subsequently combines inference by stacking of predictive densities.
}
\references{
Vehtari A, Simpson D, Gelman A, Yao Y, Gabry J (2024). “Pareto
Smoothed Importance Sampling.” \emph{Journal of Machine Learning Research},
\strong{25}(72), 1–58. URL \url{https://jmlr.org/papers/v25/19-556.html}.
}
\seealso{
\code{\link[=spLMexact]{spLMexact()}}
}
