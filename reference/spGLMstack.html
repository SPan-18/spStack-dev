<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian spatial generalized linear model using predictive stacking — spGLMstack • spStack</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian spatial generalized linear model using predictive stacking — spGLMstack"><meta name="description" content="Fits Bayesian spatial generalized linear model on a collection
of candidate models constructed based on some candidate values of some model
parameters specified by the user and subsequently combines inference by
stacking predictive densities. See Pan, Zhang, Bradley, and Banerjee (2024)
for more details."><meta property="og:description" content="Fits Bayesian spatial generalized linear model on a collection
of candidate models constructed based on some candidate values of some model
parameters specified by the user and subsequently combines inference by
stacking predictive densities. See Pan, Zhang, Bradley, and Banerjee (2024)
for more details."><meta property="og:image" content="https://span-18.github.io/spStack-dev/logo.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spStack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/spStack.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/technical_overview.html">Technical Overview</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SPan-18/spStack-dev/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bayesian spatial generalized linear model using predictive stacking</h1>
      <small class="dont-index">Source: <a href="https://github.com/SPan-18/spStack-dev/blob/master/R/spGLMstack.R" class="external-link"><code>R/spGLMstack.R</code></a></small>
      <div class="d-none name"><code>spGLMstack.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits Bayesian spatial generalized linear model on a collection
of candidate models constructed based on some candidate values of some model
parameters specified by the user and subsequently combines inference by
stacking predictive densities. See Pan, Zhang, Bradley, and Banerjee (2024)
for more details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spGLMstack</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">family</span>,</span>
<span>  <span class="va">coords</span>,</span>
<span>  <span class="va">cor.fn</span>,</span>
<span>  <span class="va">priors</span>,</span>
<span>  <span class="va">params.list</span>,</span>
<span>  <span class="va">n.samples</span>,</span>
<span>  <span class="va">loopd.controls</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  solver <span class="op">=</span> <span class="st">"ECOS"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a symbolic description of the regression model to be fit.
See example below.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an optional data frame containing the variables in the model.
If not found in <code>data</code>, the variables are taken from
<code>environment(formula)</code>, typically the environment from which
<code>spLMstack</code> is called.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>Specifies the distribution of the response as a member of the
exponential family. Supported options are <code>'poisson'</code>, <code>'binomial'</code> and
<code>'binary'</code>.</p></dd>


<dt id="arg-coords">coords<a class="anchor" aria-label="anchor" href="#arg-coords"></a></dt>
<dd><p>an \(n \times 2\) matrix of the observation
coordinates in \(\mathbb{R}^2\) (e.g., easting and northing).</p></dd>


<dt id="arg-cor-fn">cor.fn<a class="anchor" aria-label="anchor" href="#arg-cor-fn"></a></dt>
<dd><p>a quoted keyword that specifies the correlation function used
to model the spatial dependence structure among the observations. Supported
covariance model key words are: <code>'exponential'</code> and <code>'matern'</code>.
See below for details.</p></dd>


<dt id="arg-priors">priors<a class="anchor" aria-label="anchor" href="#arg-priors"></a></dt>
<dd><p>(optional) a list with each tag corresponding to a parameter
name and containing prior details. Valid tags include <code>V.beta</code>, <code>nu.beta</code>,
<code>nu.z</code> and <code>sigmaSq.xi</code>.</p></dd>


<dt id="arg-params-list">params.list<a class="anchor" aria-label="anchor" href="#arg-params-list"></a></dt>
<dd><p>a list containing candidate values of spatial process
parameters for the <code>cor.fn</code> used, and, the boundary parameter.</p></dd>


<dt id="arg-n-samples">n.samples<a class="anchor" aria-label="anchor" href="#arg-n-samples"></a></dt>
<dd><p>number of posterior samples to be generated.</p></dd>


<dt id="arg-loopd-controls">loopd.controls<a class="anchor" aria-label="anchor" href="#arg-loopd-controls"></a></dt>
<dd><p>a list with details on how leave-one-out predictive
densities (LOO-PD) are to be calculated. Valid tags include <code>method</code>, <code>CV.K</code>
and <code>nMC</code>. The tag <code>method</code> can be either <code>'exact'</code> or <code>'CV'</code>. If sample size
is more than 100, then the default is <code>'CV'</code> with <code>CV.K</code> equal to its default
value 10 (Gelman <em>et al.</em> 2024). The tag <code>nMC</code> decides how many Monte Carlo
samples will be used to evaluate the leave-one-out predictive densities,
which must be at least 500 (default).</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>logical. If <code>parallel=FALSE</code>, the parallelization plan,
if set up by the user, is ignored. If <code>parallel=TRUE</code>, the function
inherits the parallelization plan that is set by the user via the function
<code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">future::plan()</a></code> only. Depending on the parallel backend available, users
may choose their own plan. More details are available at
<a href="https://cran.R-project.org/package=future" class="external-link">https://cran.R-project.org/package=future</a>.</p></dd>


<dt id="arg-solver">solver<a class="anchor" aria-label="anchor" href="#arg-solver"></a></dt>
<dd><p>(optional) Specifies the name of the solver that will be used
to obtain optimal stacking weights for each candidate model. Default is
<code>'ECOS'</code>. Users can use other solvers supported by the
<a href="https://www.cvxgrp.org/CVXR/reference/CVXR-package.html" class="external-link">CVXR-package</a> package.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical. If <code>TRUE</code>, prints model-specific optimal
stacking weights.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>currently no additional argument.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>spGLMstack</code>, which is a list including the
following tags -</p><dl><dt><code>family</code></dt>
<dd><p>the distribution of the responses as indicated in the
function call</p></dd>

<dt><code>samples</code></dt>
<dd><p>a list of length equal to total number of candidate models
with each entry corresponding to a list of length 3, containing posterior
samples of fixed effects (<code>beta</code>), spatial effects (<code>z</code>) and
fine-scale variation term (<code>xi</code>) for that particular model.</p></dd>

<dt><code>loopd</code></dt>
<dd><p>a list of length equal to total number of candidate models with
each entry containing leave-one-out predictive densities under that
particular model.</p></dd>

<dt><code>loopd.method</code></dt>
<dd><p>a list containing details of the algorithm used for
calculation of leave-one-out predictive densities.</p></dd>

<dt><code>n.models</code></dt>
<dd><p>number of candidate models that are fit.</p></dd>

<dt><code>candidate.models</code></dt>
<dd><p>a matrix with <code>n_model</code> rows with each row
containing details of the model parameters and its optimal weight.</p></dd>

<dt><code>stacking.weights</code></dt>
<dd><p>a numeric vector of length equal to the number of
candidate models storing the optimal stacking weights.</p></dd>

<dt><code>run.time</code></dt>
<dd><p>a <code>proc_time</code> object with runtime details.</p></dd>

<dt><code>solver.status</code></dt>
<dd><p>solver status as returned by the optimization
routine.</p></dd>


</dl><p>The return object might include additional data that is useful for subsequent
prediction, model fit evaluation and other utilities.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Instead of assigning a prior on the process parameters \(\phi\)
and \(\nu\), the boundary adjustment parameter \(\epsilon\), we consider
a set of candidate models based on some candidate values of these parameters
supplied by the user. Suppose the set of candidate models is
\(\mathcal{M} = \{M_1, \ldots, M_G\}\). Then for each
\(g = 1, \ldots, G\), we sample from the posterior distribution
\(p(\sigma^2, \beta, z \mid y, M_g)\) under the model \(M_g\) and find
leave-one-out predictive densities \(p(y_i \mid y_{-i}, M_g)\). Then we
solve the optimization problem
$$
\begin{aligned}
\max_{w_1, \ldots, w_G}&amp; \, \frac{1}{n} \sum_{i = 1}^n \log \sum_{g = 1}^G
w_g p(y_i \mid y_{-i}, M_g) \\
\text{subject to} &amp; \quad w_g \geq 0, \sum_{g = 1}^G w_g = 1
\end{aligned}
$$
to find the optimal stacking weights \(\hat{w}_1, \ldots, \hat{w}_G\).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Pan S, Zhang L, Bradley JR, Banerjee S (2024). "Bayesian
Inference for Spatial-temporal Non-Gaussian Data Using Predictive Stacking."
<a href="https://doi.org/10.48550/arXiv.2406.04655" class="external-link">doi:10.48550/arXiv.2406.04655</a>
.</p>
<p>Vehtari A, Simpson D, Gelman A, Yao Y, Gabry J (2024). "Pareto
Smoothed Importance Sampling." <em>Journal of Machine Learning Research</em>,
<strong>25</strong>(72), 1-58. URL <a href="https://jmlr.org/papers/v25/19-556.html" class="external-link">https://jmlr.org/papers/v25/19-556.html</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="spGLMexact.html">spGLMexact()</a></code>, <code><a href="spLMstack.html">spLMstack()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Soumyakanti Pan <a href="mailto:span18@ucla.edu">span18@ucla.edu</a>,<br>
Sudipto Banerjee <a href="mailto:sudipto@ucla.edu">sudipto@ucla.edu</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"simPoisson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">simPoisson</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">spGLMstack</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span>, data <span class="op">=</span> <span class="va">dat</span>, family <span class="op">=</span> <span class="st">"poisson"</span>,</span></span>
<span class="r-in"><span>                   coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s1"</span>, <span class="st">"s2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, cor.fn <span class="op">=</span> <span class="st">"matern"</span>,</span></span>
<span class="r-in"><span>                  params.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>phi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">10</span><span class="op">)</span>, nu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                     boundary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  n.samples <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>                  loopd.controls <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"CV"</span>, CV.K <span class="op">=</span> <span class="fl">10</span>, nMC <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  parallel <span class="op">=</span> <span class="cn">TRUE</span>, solver <span class="op">=</span> <span class="st">"ECOS"</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> STACKING WEIGHTS:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            | phi | nu   | boundary | weight |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +----------+-----+------+----------+--------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 1  |    3|  0.25|       0.5| 0.000  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 2  |    7|  0.25|       0.5| 0.000  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 3  |   10|  0.25|       0.5| 0.000  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 4  |    3|  0.50|       0.5| 0.000  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 5  |    7|  0.50|       0.5| 0.000  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 6  |   10|  0.50|       0.5| 0.000  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 7  |    3|  1.50|       0.5| 0.000  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 8  |    7|  1.50|       0.5| 0.000  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 9  |   10|  1.50|       0.5| 0.000  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 10 |    3|  0.25|       0.6| 0.000  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 11 |    7|  0.25|       0.6| 0.000  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 12 |   10|  0.25|       0.6| 0.000  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 13 |    3|  0.50|       0.6| 0.000  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 14 |    7|  0.50|       0.6| 0.000  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 15 |   10|  0.50|       0.6| 0.000  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 16 |    3|  1.50|       0.6| 0.308  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 17 |    7|  1.50|       0.6| 0.692  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> | Model 18 |   10|  1.50|       0.6| 0.000  |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +----------+-----+------+----------+--------+</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># print(mod1$solver.status)</span></span></span>
<span class="r-in"><span><span class="co"># print(mod1$run.time)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">post_samps</span> <span class="op">&lt;-</span> <span class="fu"><a href="stackedSampler.html">stackedSampler</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">post_beta</span> <span class="op">&lt;-</span> <span class="va">post_samps</span><span class="op">$</span><span class="va">beta</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">post_beta</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   2.5%        50%      97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.1164469  2.0658165  4.1590644</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1          -0.7185644 -0.5657866 -0.4358653</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">post_z</span> <span class="op">&lt;-</span> <span class="va">post_samps</span><span class="op">$</span><span class="va">z</span></span></span>
<span class="r-in"><span><span class="va">post_z_summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">post_z</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">z_combn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>z <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">z_true</span>,</span></span>
<span class="r-in"><span>                      zL <span class="op">=</span> <span class="va">post_z_summ</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                      zM <span class="op">=</span> <span class="va">post_z_summ</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                      zU <span class="op">=</span> <span class="va">post_z_summ</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plot_z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">z_combn</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">zL</span>, ymax <span class="op">=</span> <span class="va">zU</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               width <span class="op">=</span> <span class="fl">0.05</span>, alpha <span class="op">=</span> <span class="fl">0.15</span>,</span></span>
<span class="r-in"><span>               color <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">zM</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.25</span>,</span></span>
<span class="r-in"><span>            color <span class="op">=</span> <span class="st">"darkblue"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>             color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"True z"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Posterior of z"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Soumyakanti Pan, Sudipto Banerjee.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

