<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Univariate Bayesian spatial generalized linear model — spGLMexact • spStack</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Univariate Bayesian spatial generalized linear model — spGLMexact"><meta name="description" content="Fits a Bayesian spatial generalized linear model with fixed
values of spatial process parameters and some auxiliary model parameters. The
output contains posterior samples of the fixed effects, spatial random
effects and, if required, finds leave-one-out predictive densities."><meta property="og:description" content="Fits a Bayesian spatial generalized linear model with fixed
values of spatial process parameters and some auxiliary model parameters. The
output contains posterior samples of the fixed effects, spatial random
effects and, if required, finds leave-one-out predictive densities."><meta property="og:image" content="https://span-18.github.io/spStack-dev/logo.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spStack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/spStack.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/posterior-predictive.html">Posterior Predictive Inference</a></li>
    <li><a class="dropdown-item" href="../articles/spatial-temporal.html">Spatial-Temporal Regression Models</a></li>
    <li><a class="dropdown-item" href="../articles/spatial.html">Spatial Regression Models</a></li>
    <li><a class="dropdown-item" href="../articles/technical_overview.html">Technical Overview</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SPan-18/spStack-dev/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Univariate Bayesian spatial generalized linear model</h1>
      <small class="dont-index">Source: <a href="https://github.com/SPan-18/spStack-dev/blob/master/R/spGLMexact.R" class="external-link"><code>R/spGLMexact.R</code></a></small>
      <div class="d-none name"><code>spGLMexact.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a Bayesian spatial generalized linear model with fixed
values of spatial process parameters and some auxiliary model parameters. The
output contains posterior samples of the fixed effects, spatial random
effects and, if required, finds leave-one-out predictive densities.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spGLMexact</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">family</span>,</span>
<span>  <span class="va">coords</span>,</span>
<span>  <span class="va">cor.fn</span>,</span>
<span>  <span class="va">priors</span>,</span>
<span>  <span class="va">spParams</span>,</span>
<span>  boundary <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  <span class="va">n.samples</span>,</span>
<span>  loopd <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  loopd.method <span class="op">=</span> <span class="st">"exact"</span>,</span>
<span>  CV.K <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  loopd.nMC <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a symbolic description of the regression model to be fit.
See example below.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an optional data frame containing the variables in the model.
If not found in <code>data</code>, the variables are taken from
<code>environment(formula)</code>, typically the environment from which
<code>spGLMexact</code> is called.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>Specifies the distribution of the response as a member of the
exponential family. Supported options are <code>'poisson'</code>, <code>'binomial'</code> and
<code>'binary'</code>.</p></dd>


<dt id="arg-coords">coords<a class="anchor" aria-label="anchor" href="#arg-coords"></a></dt>
<dd><p>an \(n \times 2\) matrix of the observation
coordinates in \(\mathbb{R}^2\) (e.g., easting and northing).</p></dd>


<dt id="arg-cor-fn">cor.fn<a class="anchor" aria-label="anchor" href="#arg-cor-fn"></a></dt>
<dd><p>a quoted keyword that specifies the correlation function used
to model the spatial dependence structure among the observations. Supported
covariance model key words are: <code>'exponential'</code> and <code>'matern'</code>.
See below for details.</p></dd>


<dt id="arg-priors">priors<a class="anchor" aria-label="anchor" href="#arg-priors"></a></dt>
<dd><p>(optional) a list with each tag corresponding to a
hyperparameter name and containing hyperprior details. Valid tags include
<code>V.beta</code>, <code>nu.beta</code>, <code>nu.z</code> and <code>sigmaSq.xi</code>. Values of <code>nu.beta</code> and <code>nu.z</code>
must be at least 2.1. If not supplied, uses defaults.</p></dd>


<dt id="arg-spparams">spParams<a class="anchor" aria-label="anchor" href="#arg-spparams"></a></dt>
<dd><p>fixed values of spatial process parameters.</p></dd>


<dt id="arg-boundary">boundary<a class="anchor" aria-label="anchor" href="#arg-boundary"></a></dt>
<dd><p>Specifies the boundary adjustment parameter. Must be a real
number between 0 and 1. Default is 0.5.</p></dd>


<dt id="arg-n-samples">n.samples<a class="anchor" aria-label="anchor" href="#arg-n-samples"></a></dt>
<dd><p>number of posterior samples to be generated.</p></dd>


<dt id="arg-loopd">loopd<a class="anchor" aria-label="anchor" href="#arg-loopd"></a></dt>
<dd><p>logical. If <code>loopd=TRUE</code>, returns leave-one-out predictive
densities, using method as given by <code>loopd.method</code>. Default is
<code>FALSE</code>.</p></dd>


<dt id="arg-loopd-method">loopd.method<a class="anchor" aria-label="anchor" href="#arg-loopd-method"></a></dt>
<dd><p>character. Ignored if <code>loopd=FALSE</code>. If <code>loopd=TRUE</code>,
valid inputs are <code>'exact'</code>, <code>'CV'</code> and <code>'PSIS'</code>. The option <code>'exact'</code>
corresponds to exact leave-one-out predictive densities which requires
computation almost equivalent to fitting the model \(n\) times. The
options <code>'CV'</code> and <code>'PSIS'</code> are faster and they implement \(K\)-fold
cross validation and Pareto-smoothed importance sampling to find approximate
leave-one-out predictive densities (Vehtari <em>et al.</em> 2017).</p></dd>


<dt id="arg-cv-k">CV.K<a class="anchor" aria-label="anchor" href="#arg-cv-k"></a></dt>
<dd><p>An integer between 10 and 20. Considered only if
<code>loopd.method='CV'</code>. Default is 10 (as recommended in Vehtari <em>et. al</em> 2017).</p></dd>


<dt id="arg-loopd-nmc">loopd.nMC<a class="anchor" aria-label="anchor" href="#arg-loopd-nmc"></a></dt>
<dd><p>Number of Monte Carlo samples to be used to evaluate
leave-one-out predictive densities when <code>loopd.method</code> is set to either
'exact' or 'CV'.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical. If <code>verbose = TRUE</code>, prints model description.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>currently no additional argument.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>spGLMexact</code>, which is a list with the
following tags -</p><dl><dt>priors</dt>
<dd><p>details of the priors used, containing the values of the
boundary adjustment parameter (<code>boundary</code>), the variance parameter of the
fine-scale variation term (<code>simasq.xi</code>) and others.</p></dd>

<dt>samples</dt>
<dd><p>a list of length 3, containing posterior samples of fixed
effects (<code>beta</code>), spatial effects (<code>z</code>) and the fine-scale
variation term (<code>xi</code>).</p></dd>

<dt>loopd</dt>
<dd><p>If <code>loopd=TRUE</code>, contains leave-one-out predictive
densities.</p></dd>

<dt>model.params</dt>
<dd><p>Values of the fixed parameters that includes
<code>phi</code> (spatial decay), <code>nu</code> (spatial smoothness).</p></dd>


</dl><p>The return object might include additional data that can be used for
subsequent prediction and/or model fit evaluation.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>With this function, we fit a Bayesian hierarchical spatial
generalized linear model by sampling exactly from the joint posterior
distribution utilizing the generalized conjugate multivariate distribution
theory (Bradley and Clinch 2024). Suppose \(\chi = (s_1, \ldots, s_n)\)
denotes the \(n\) spatial locations the response \(y\) is observed. Let
\(y(s)\) be the outcome at location \(s\) endowed with a probability law
from the natural exponential family, which we denote by
$$
y(s) \sim \mathrm{EF}(x(s)^\top \beta + z(s); b, \psi)
$$
for some positive parameter \(b &gt; 0\) and unit log partition function
\(\psi\). We consider the following response models based on the input
supplied to the argument <code>family</code>.</p><dl><dt><code>'poisson'</code></dt>
<dd><p>It considers point-referenced Poisson responses
\(y(s) \sim \mathrm{Poisson}(e^{x(s)^\top \beta + z(s)})\). Here,
\(b = 1\) and \(\psi(t) = e^t\).</p></dd>

<dt><code>'binomial'</code></dt>
<dd><p>It considers point-referenced binomial counts
\(y(s) \sim \mathrm{Binomial}(m(s), \pi(s))\) where, \(m(s)\) denotes
the total number of trials and probability of success
\(\pi(s) = \mathrm{ilogit}(x(s)^\top \beta + z(s))\) at location \(s\).
Here, \(b = m(s)\) and \(\psi(t) = \log(1+e^t)\).</p></dd>

<dt><code>'binary'</code></dt>
<dd><p>It considers point-referenced binary data (0 or, 1) i.e.,
\(y(s) \sim \mathrm{Bernoulli}(\pi(s))\), where probability of success
\(\pi(s) = \mathrm{ilogit}(x(s)^\top \beta + z(s))\) at location \(s\).
Here, \(b = 1\) and \(\psi(t) = \log(1 + e^t)\).</p></dd>


</dl><p>The hierarchical model is given as
$$
\begin{aligned}
y(s_i) &amp;\mid \beta, z, \xi \sim EF(x(s_i)^\top \beta + z(s_i) +
\xi_i - \mu_i; b_i, \psi_y), i = 1, \ldots, n\\
\xi &amp;\mid \beta, z, \sigma^2_\xi, \alpha_\epsilon \sim
\mathrm{GCM_c}(\cdots),\\
\beta &amp;\mid \sigma^2_\beta \sim N(0, \sigma^2_\beta V_\beta), \quad
\sigma^2_\beta \sim \mathrm{IG}(\nu_\beta/2, \nu_\beta/2)\\
z &amp;\mid \sigma^2_z \sim N(0, \sigma^2_z R(\chi; \phi, \nu)), \quad
\sigma^2_z \sim \mathrm{IG}(\nu_z/2, \nu_z/2),
\end{aligned}
$$
where \(\mu = (\mu_1, \ldots, \mu_n)^\top\) denotes the discrepancy
parameter. We fix the spatial process parameters \(\phi\) and \(\nu\) and
the hyperparameters \(V_\beta\), \(\nu_\beta\), \(\nu_z\) and
\(\sigma^2_\xi\). The term \(\xi\) is known as the fine-scale variation
term which is given a conditional generalized conjugate multivariate
distribution as prior. For more details, see Pan <em>et al.</em> 2024. Default
values for \(V_\beta\), \(\nu_\beta\), \(\nu_z\), \(\sigma^2_\xi\)
are diagonal with each diagonal element 100, 2.1, 2.1 and 0.1 respectively.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bradley JR, Clinch M (2024). "Generating Independent Replicates
Directly from the Posterior Distribution for a Class of Spatial Hierarchical
Models." <em>Journal of Computational and Graphical Statistics</em>, <strong>0</strong>(0), 1-17.
<a href="https://doi.org/10.1080/10618600.2024.2365728" class="external-link">doi:10.1080/10618600.2024.2365728</a>
.</p>
<p>Pan S, Zhang L, Bradley JR, Banerjee S (2024). "Bayesian
Inference for Spatial-temporal Non-Gaussian Data Using Predictive Stacking."
<a href="https://doi.org/10.48550/arXiv.2406.04655" class="external-link">doi:10.48550/arXiv.2406.04655</a>
.</p>
<p>Vehtari A, Gelman A, Gabry J (2017). "Practical Bayesian Model
Evaluation Using Leave-One-out Cross-Validation and WAIC."
<em>Statistics and Computing</em>, <strong>27</strong>(5), 1413-1432. ISSN 0960-3174.
<a href="https://doi.org/10.1007/s11222-016-9696-4" class="external-link">doi:10.1007/s11222-016-9696-4</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="spLMexact.html">spLMexact()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Soumyakanti Pan <a href="mailto:span18@ucla.edu">span18@ucla.edu</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1: Analyze spatial poisson count data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">simPoisson</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">simPoisson</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">spGLMexact</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span>, data <span class="op">=</span> <span class="va">dat</span>, family <span class="op">=</span> <span class="st">"poisson"</span>,</span></span>
<span class="r-in"><span>                   coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s1"</span>, <span class="st">"s2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   cor.fn <span class="op">=</span> <span class="st">"matern"</span>,</span></span>
<span class="r-in"><span>                   spParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>phi <span class="op">=</span> <span class="fl">4</span>, nu <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   n.samples <span class="op">=</span> <span class="fl">100</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Model description</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit with 10 observations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family = poisson.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of covariates 2 (including intercept).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using the matern spatial correlation function.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Priors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	beta: Gaussian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	mu:	0.00	0.00	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	cov:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 100.00	 0.00	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 0.00	 100.00	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	sigmaSq.beta ~ IG(nu.beta/2, nu.beta/2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	sigmaSq.z ~ IG(nu.z/2, nu.z/2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	nu.beta = 2.10, nu.z = 2.10.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	sigmaSq.xi = 0.10.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Boundary adjustment parameter = 0.50.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial process parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	phi = 4.00, and, nu = 0.40.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of posterior samples = 100.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># summarize posterior samples</span></span></span>
<span class="r-in"><span><span class="va">post_beta</span> <span class="op">&lt;-</span> <span class="va">mod1</span><span class="op">$</span><span class="va">samples</span><span class="op">$</span><span class="va">beta</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">post_beta</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            2.5%        50%     97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.4031546  2.1316362 4.3996223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -1.2780079 -0.4119679 0.6808467</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Analyze spatial binomial count data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">simBinom</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">simBinom</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">spGLMexact</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">n_trials</span><span class="op">)</span> <span class="op">~</span> <span class="va">x1</span>, data <span class="op">=</span> <span class="va">dat</span>, family <span class="op">=</span> <span class="st">"binomial"</span>,</span></span>
<span class="r-in"><span>                   coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s1"</span>, <span class="st">"s2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   cor.fn <span class="op">=</span> <span class="st">"matern"</span>,</span></span>
<span class="r-in"><span>                   spParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>phi <span class="op">=</span> <span class="fl">3</span>, nu <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   n.samples <span class="op">=</span> <span class="fl">100</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Model description</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit with 10 observations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family = binomial.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of covariates 2 (including intercept).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using the matern spatial correlation function.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Priors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	beta: Gaussian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	mu:	0.00	0.00	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	cov:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 100.00	 0.00	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 0.00	 100.00	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	sigmaSq.beta ~ IG(nu.beta/2, nu.beta/2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	sigmaSq.z ~ IG(nu.z/2, nu.z/2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	nu.beta = 2.10, nu.z = 2.10.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	sigmaSq.xi = 0.10.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Boundary adjustment parameter = 0.50.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial process parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	phi = 3.00, and, nu = 0.40.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of posterior samples = 100.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># summarize posterior samples</span></span></span>
<span class="r-in"><span><span class="va">post_beta</span> <span class="op">&lt;-</span> <span class="va">mod2</span><span class="op">$</span><span class="va">samples</span><span class="op">$</span><span class="va">beta</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">post_beta</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            2.5%        50%     97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.6230326  1.0619639 2.6529332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -1.9705288 -0.5585171 0.4772962</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: Analyze spatial binary data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">simBinary</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">simBinary</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">spGLMexact</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span>, data <span class="op">=</span> <span class="va">dat</span>, family <span class="op">=</span> <span class="st">"binary"</span>,</span></span>
<span class="r-in"><span>                   coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s1"</span>, <span class="st">"s2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   cor.fn <span class="op">=</span> <span class="st">"matern"</span>,</span></span>
<span class="r-in"><span>                   spParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>phi <span class="op">=</span> <span class="fl">4</span>, nu <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   n.samples <span class="op">=</span> <span class="fl">100</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Model description</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit with 10 observations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family = binary.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of covariates 2 (including intercept).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using the matern spatial correlation function.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Priors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	beta: Gaussian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	mu:	0.00	0.00	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	cov:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 100.00	 0.00	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 0.00	 100.00	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	sigmaSq.beta ~ IG(nu.beta/2, nu.beta/2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	sigmaSq.z ~ IG(nu.z/2, nu.z/2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	nu.beta = 2.10, nu.z = 2.10.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	sigmaSq.xi = 0.10.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Boundary adjustment parameter = 0.50.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spatial process parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	phi = 4.00, and, nu = 0.40.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of posterior samples = 100.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># summarize posterior samples</span></span></span>
<span class="r-in"><span><span class="va">post_beta</span> <span class="op">&lt;-</span> <span class="va">mod3</span><span class="op">$</span><span class="va">samples</span><span class="op">$</span><span class="va">beta</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">post_beta</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           2.5%        50%    97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -1.099885  0.9949421 3.572417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -2.135907 -0.3900626 1.299150</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Soumyakanti Pan, Sudipto Banerjee.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

